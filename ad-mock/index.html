<!DOCTYPE html>
<html>

<head>
    <!-- Adding the FabricJS library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/3.6.2/fabric.min.js">
    </script>
</head>

<body>
    <div style="display: flex">
        <a href="../pan-mock/index.html">PAN</a> &nbsp;|&nbsp;
        <a href="../ad-mock/index.html">Aadhar</a> &nbsp;|&nbsp;
        <a href="../dl-mock/index.html">Driving License</a>
    </div>
    <div id="wrapper" style="display: flex;flex-direction: row;">

        <div style="display: flex;flex-direction: column;width: 200px;margin-left: 10px;margin-right: 10px; ">
            <span>Selected</span>
            <textarea id="selectd" onkeyup="onselectedupdate()"></textarea>

            <span>Image</span>
            <input id="pic" disabled>

            <a href="#" id="download" onclick="saveImage()">Download Photo</a></div>

        <canvas id="canvas" width="636" height="210" style="border:0px solid #000000"> 
                </canvas>
        <div style="margin-left: 10px;margin-right: 10px;">
            <div style="width: 300px; height: 300px; overflow: hidden;">
                <video style="width: 100%;height:100%;"></video>
            </div>
            <canvas style="display: none;" id="videoImg"></canvas>
            <br />
            <button id="newphoto">Take A Photo</button>
            <button id="download" disabled="disabled" style="display: none;">Download Photo</button>

        </div>
    </div>

    <button onclick="exportd()">export</button>

    <button onclick="addText()">Add Text</button>
    <button onclick="AddImage()">Add Image</button>


    <script>
        var d = '{\"version\":\"3.6.2\",\"objects\":[{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":100,\"top\":165.6,\"width\":91,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":1.03,\"scaleY\":1.03,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"8698 3013 3361\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":100,\"top\":66,\"width\":156.35,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.78,\"scaleY\":0.78,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"PRATIK PRAKASH NAIK\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":100,\"top\":52,\"width\":94.12,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.65,\"scaleY\":0.65,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"\u092A\u094D\u0930\u0924\u093F\u0915 \u092A\u094D\u0930\u0915\u093E\u0936 \u0928\u093E\u0908\u0915\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":101,\"top\":84,\"width\":168.48,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.57,\"scaleY\":0.57,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"\u091C\u0928\u094D\u092E \u0924\u093E\u0930\u0940\u0916 \/ DOB: 11\/08\/1989\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":102,\"top\":99,\"width\":2,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.57,\"scaleY\":0.57,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":347,\"top\":49,\"width\":520.74,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.66,\"scaleY\":0.66,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"\u092A\u0924\u093E \u0938\u0940-1201, \u090F\u0915\u0926\u0902\u0924 \u0938\u093E\u0935\u0932\u093E\u0930\u093E\u092E \u0938\u0943\u0937\u094D\u091F\u093F, \u0906\u0930\u091F\u0940\u0913 \u0930\u094B\u0921, \u0915\u0932\u094D\u092F\u093E\u0923 \\n\u092A\u0936\u094D\u091A\u093F\u092E, \u0915\u0932\u094D\u092F\u093E\u0923, \u0920\u093E\u0923\u0947, \u092E\u0939\u093E\u0930\u093E\u0937\u094D\u091F\u094D\u0930, 421301\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":348,\"top\":107,\"width\":595.31,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.65,\"scaleY\":0.65,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"Address: C-1201, Ekdant Sawlaram Srushti, Rto Road, Kalyan \\nWest, Kalyan, Thane,Maharashtra, 421301\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"text\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":424.47,\"top\":166.53,\"width\":91,\"height\":15.82,\"fill\":\"black\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":1.05,\"scaleY\":1.05,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"text\":\"8698 3013 3361\",\"fontSize\":\"14\",\"fontWeight\":\"normal\",\"fontFamily\":\"Calibri\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"styles\":{}},{\"type\":\"image\",\"version\":\"3.6.2\",\"originX\":\"left\",\"originY\":\"top\",\"left\":10,\"top\":53,\"width\":132.28,\"height\":90.49,\"fill\":\"rgb(0,0,0)\",\"stroke\":null,\"strokeWidth\":0,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.61,\"scaleY\":0.99,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"crossOrigin\":\"\",\"cropX\":0,\"cropY\":0,\"src\":\"data:image\/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAApgAAAKYB3X3\/OAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANCSURBVEiJtZZPbBtFFMZ\/M7ubXdtdb1xSFyeilBapySVU8h8OoFaooFSqiihIVIpQBKci6KEg9Q6H9kovIHoCIVQJJCKE1ENFjnAgcaSGC6rEnxBwA04Tx43t2FnvDAfjkNibxgHxnWb2e\/u992bee7tCa00YFsffekFY+nUzFtjW0LrvjRXrCDIAaPLlW0nHL0SsZtVoaF98mLrx3pdhOqLtYPHChahZcYYO7KvPFxvRl5XPp1sN3adWiD1ZAqD6XYK1b\/dvE5IWryTt2udLFedwc1+9kLp+vbbpoDh+6TklxBeAi9TL0taeWpdmZzQDry0AcO+jQ12RyohqqoYoo8RDwJrU+qXkjWtfi8Xxt58BdQuwQs9qC\/afLwCw8tnQbqYAPsgxE1S6F3EAIXux2oQFKm0ihMsOF71dHYx+f3NND68ghCu1YIoePPQN1pGRABkJ6Bus96CutRZMydTl+TvuiRW1m3n0eDl0vRPcEysqdXn+jsQPsrHMquGeXEaY4Yk4wxWcY5V\/9scqOMOVUFthatyTy8QyqwZ+kDURKoMWxNKr2EeqVKcTNOajqKoBgOE28U4tdQl5p5bwCw7BWquaZSzAPlwjlithJtp3pTImSqQRrb2Z8PHGigD4RZuNX6JYj6wj7O4TFLbCO\/Mn\/m8R+h6rYSUb3ekokRY6f\/YukArN979jcW+V\/S8g0eT\/N3VN3kTqWbQ428m9\/8k0P\/1aIhF36PccEl6EhOcAUCrXKZXXWS3XKd2vc\/TRBG9O5ELC17MmWubD2nKhUKZa26Ba2+D3P+4\/MNCFwg59oWVeYhkzgN\/JDR8deKBoD7Y+ljEjGZ0sosXVTvbc6RHirr2reNy1OXd6pJsQ+gqjk8VWFYmHrwBzW\/n+uMPFiRwHB2I7ih8ciHFxIkd\/3Omk5tCDV1t+2nNu5sxxpDFNx+huNhVT3\/zMDz8usXC3ddaHBj1GHj\/As08fwTS7Kt1HBTmyN29vdwAw+\/wbwLVOJ3uAD1wi\/dUH7Qei66PfyuRj4Ik9is+hglfbkbfR3cnZm7chlUWLdwmprtCohX4HUtlOcQjLYCu+fzGJH2QRKvP3UNz8bWk1qMxjGTOMThZ3kvgLI5AzFfo379UAAAAASUVORK5CYII=\",\"filters\":[]}],\"backgroundImage\":{\"type\":\"image\",\"version\":\"3.6.2\",\"originX\":\"middle\",\"originY\":\"middle\",\"left\":318,\"top\":105,\"width\":1326,\"height\":432,\"fill\":\"rgb(0,0,0)\",\"stroke\":null,\"strokeWidth\":0,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeMiterLimit\":4,\"scaleX\":0.48,\"scaleY\":0.48,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"clipTo\":null,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"transformMatrix\":null,\"skewX\":0,\"skewY\":0,\"crossOrigin\":\"\",\"cropX\":0,\"cropY\":0,\"src\":\".\/assets\/aadhar-short.png\",\"filters\":[]}}';
        //Create a new instance of Canvas
        var canvas = new fabric.Canvas("canvas");
        canvas.on({
            'selection:updated': HandleElement,
            'selection:created': HandleElement
        });
        var sel = {};

        function HandleElement(obj) {
            sel = obj;
            document.getElementById("selectd").value = obj.target.text;

        }

        function onselectedupdate() {
            var object = canvas.getActiveObject();
            object.set("text", document.getElementById("selectd").value.toUpperCase())
            canvas.renderAll();
        }

        fabric.Image.fromURL('./assets/aadhar-short.png', img => {
            img.top = 10;
            img.left = 10;
            let scaleRatio = Math.min(canvas.width / img.width, canvas.height / img.height);

            canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas), {
                scaleX: scaleRatio,
                scaleY: scaleRatio,
                left: canvas.width / 2,
                top: canvas.height / 2,
                originX: 'middle',
                originY: 'middle'
            });
            canvas.renderAll();
        });


        function loadCanvas(d) {
            canvas.clear();
            canvas.loadFromJSON(d, canvas.renderAll.bind(canvas), function(o, object) {
                // object.set('selectable', false);

                object.setControlsVisibility({
                    mt: false,
                    mb: false,
                    ml: false,
                    mr: false,
                    bl: false,
                    br: false,
                    tl: false,
                    tr: false,
                    mtr: false,
                });

                object.lockMovementX = true
                object.lockMovementY = true

                // making sure to render canvas at the end
                canvas.renderAll();

                // and checking if object   's "name" is preserved

            });
        }


        loadCanvas(d);



        function exportd() {
            console.log(JSON.stringify(canvas))
        }
    </script>



    <script src="./video.js">
    </script>

    <script>
        function onupdate() {
            var json = JSON.parse(JSON.stringify(canvas));
            if (document.getElementById("pic").value != '') {
                json.objects[8].src = document.getElementById("pic").value;
            }
            loadCanvas(json);
        }



        function saveImage(e) {


            document.querySelector('#canvas').toBlob(function(blob) {
                var link = document.createElement('a');
                link.download = 'aadhar.png';
                link.setAttribute('href', URL.createObjectURL(blob));
                link.dispatchEvent(new MouseEvent('click'));

            }, 'image/jpeg', 1);


        }
    </script>

</body>


</html>